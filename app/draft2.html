<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>CodePen - dagre</title>
  <link rel="stylesheet" href="./style.css">
  <style>
    .tree {
      display: flex;
      justify-content: center;
    }
    .graph {
      border: none;
    }
    .graph text, .graph .node.root div {
      fill: #333;
      font-weight: 300;
      font-family: "Avenir Next", "Helvetica Neue", Helvetica, Arial, sans-serif;
      font-weight: 400;
      font-size: 14px;
    }
    .graph .node rect {
      stroke: #ccc;
      fill: #fff;
      stroke-width: 2px;
    }
    /*
    .graph .node.root rect {
      stroke: none;
    }
    */
    .graph .node.disabled rect {
      stroke-dasharray: 5,5;
    }
    .graph .node.disabled text {
      fill: #333;
    }
    .graph .edgePath path {
      stroke: #aaa;
      fill: #aaa;
      stroke-width: 2px;
    }
    /* Arrowhead */
    .graph .edgePath marker path {
      stroke: none;
    }
  </style>
</head>
<body>
  <h1>Pre-requisite Tree</h1>
  <br>
<!-- partial:index.partial.html -->
<div class="tree">
  <svg class="graph"></svg>

</div>
<!-- partial -->
  <script src='https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.16/d3.min.js'></script>
  <script src='https://cdnjs.cloudflare.com/ajax/libs/dagre-d3/0.4.17/dagre-d3.min.js'></script>
  <script>
    /*const raw_data = [
        {
            "code": "204111",
            "parent list": "None",
            "child list": ["204114"],
            "credit": 3,
            "full Name": "Fundamentals of Programming",
            "year": 1,
            "abbr": "CS111",
            "term": 1

        },
        {
            "code": "204114",
            "parent list": "[204111]",
            "child list": "[204203, 204212, 204231, 204232, 204252]",
            "credit": 3,
            "full Name": "Introduction to Object-oriented Programming",
            "year": 1,
            "abbr": "CS114",
            "term": 2
        },
        {
            "code": "204203",
            "parent list": "[204114]",
            "child list": "None",
            "credit": 3,
            "full Name": "Computer Science Technology",
            "year": 2,
            "abbr": "CS203",
            "term": 1
        },
        {
            "code": "204212",
            "parent list": "[204114]",
            "child list": "[204315, 204361]",
            "credit": 3,
            "full Name": "Modern Application Development",
            "year": 2,
            "abbr": "CS212",
            "term": 2
        },
        {
            "code": "204231",
            "parent list": "[204114]",
            "child list": "[204341]",
            "credit": 3,
            "full Name": "Computer Organization and Architecture",
            "year": 2,
            "abbr": "CS231",
            "term": 1
        },
        {
            "code": "204232",
            "parent list": "[204114]",
            "child list": "[204390]",
            "credit": 3,
            "full Name": "Computer Networks and Protocols",
            "year": 2,
            "abbr": "CS232",
            "term": 2
        },
        {
            "code": "204252",
            "parent list": "[204114]",
            "child list": "[204271, 204321, 204451]",
            "credit": 3,
            "full Name": "Data Structures and Analysis",
            "year": 2,
            "abbr": "CS252",
            "term": 1
        },
        {   
            // special characters
            "code": "204271",
            "parent list": "[204252, 208269]",
            "child list": "None",
            "credit": 3,
            "full Name": "Introduction to Artificial Intelligence",
            "year": 2,
            "abbr": "CS271",
            "term": 2
        },
        {
            "code": "204306",
            "parent list": "Third year standing",
            "child list": "None",
            "credit": 1,
            "full Name": "Ethics for Computer Professionals",
            "year": 3,
            "abbr": "CS306",
            "term": 2
        },
        {
            "code": "204315",
            "parent list": "[204212]",
            "child list": "None",
            "credit": 3,
            "full Name": "Organization of Programming Languages",
            "year": 3,
            "abbr": "CS315",
            "term": 2
        },
        {
            "code": "204321",
            "parent list": "[(204251, 204252)]",
            "child list": "None",
            "credit": 3,
            "full Name": "Database Systems",
            "year": 3,
            "abbr": "CS321",
            "term": 1
        },
        {
            "code": "204341",
            "parent list": "[204231]",
            "child list": "[204390]",
            "credit": 3,
            "full Name": "Operating Systems",
            "year": 3,
            "abbr": "CS341",
            "term": 1
        },
        {
            "code": "204361",
            "parent list": "[204212]",
            "child list": "[204390]",
            "credit": 3,
            "full Name": "Software Engineering",
            "year": 3,
            "abbr": "CS361",
            "term": 1
        },
        {
            // special characters
            "code": "204451",
            "parent list": "[(204251, 204252), (206183, 206281)]",
            "child list": "None",
            "credit": 3,
            "full Name": "Algorithm Design and Analysis",
            "year": 3,
            "abbr": "CS451",
            "term": 1
        },
        {
            "code": "204490",
            "parent list": "Consent of the department",
            "child list": "None",
            "credit": 3,
            "full Name": "Research in Computer Science",
            "year": 3,
            "abbr": "CS490",
            "term": 2
        },
        {
            "code": "204390",
            "parent list": "[204232, 204321, 204341, 204361]",
            "child list": "None",
            "credit": 1,
            "full Name": "Computer Job Training",
            "year": 4,
            "abbr": "CS390",
            "term": 1
        },
        {
            "code": "204496",
            "parent list": "Fourth year standing and Consent of the department",
            "child list": "None",
            "credit": 6,
            "full Name": "Cooperative Education",
            "year": 4,
            "abbr": "CS496",
            "term": 1
        },
        {
            "code": "204497",
            "parent list": "Consent of the department",
            "child list": "None",
            "credit": 1,
            "full Name": "Seminar in Computer Science",
            "year": 4,
            "abbr": "CS497",
            "term": 2
        }

    ]
    */
    var dagre = dagreD3.dagre;
    var graphlib = dagreD3.graphlib;
    var render = dagreD3.render();
    var PADDING = 120;

    // Create a new directed graph 
    var g = new graphlib.Graph();

    // Set an object for the graph label
    g.setGraph({
      ranksep: 100,
    });

    // Default to assigning a new object as a label for each new edge.
    g.setDefaultEdgeLabel(function() { return {}; });

    g.setNode("204111", {label: "CS111", width: 50, height: 30, id: "204111" });
    g.setNode("204114", {label: "CS114", width: 50, height: 30, id: "204114"});
    g.setNode("204203", {label: "CS203", width: 50, height: 30, id: "204203"});
    g.setNode("204212", {label: "CS212", width: 50, height: 30, id: "204212"});
    g.setNode("204231", {label: "CS231", width: 50, height: 30, id: "204231"});
    g.setNode("204232", {label: "CS232", width: 50, height: 30, id: "204232"});
    g.setNode("204252", {label: "CS252", width: 50, height: 30, id: "204252"});
    g.setNode("208269", {label: "Stat269", width: 50, height: 30, id: "208269", class: "disabled"});
    g.setNode("206183", {label: "Math183", width: 50, height: 30, id: "206183", class: "disabled"});
    g.setNode("204271", {label: "CS271", width: 50, height: 30, id: "204271"});
    g.setNode("204321", {label: "CS321", width: 50, height: 30, id: "204321"});
    g.setNode("204341", {label: "CS341", width: 50, height: 30, id: "204341"});
    g.setNode("204361", {label: "CS361", width: 50, height: 30, id: "204361"});
    g.setNode("204451", {label: "CS451", width: 50, height: 30, id: "204451"});
    g.setNode("204306", {label: "CS306", width: 50, height: 30, id: "204306"});
    g.setNode("204315", {label: "CS315", width: 50, height: 30, id: "204315"});
    g.setNode("204490", {label: "CS490", width: 50, height: 30, id: "204490"});
    g.setNode("204390", {label: "CS390", width: 50, height: 30, id: "204390"});
    g.setNode("204496", {label: "CS496", width: 50, height: 30, id: "204496"});
    g.setNode("204497", {label: "CS497", width: 50, height: 30, id: "204497"});
    /*
    g.setNode("init", { labelType: 'html', label: 'Init rule', width: 120, height: 10, class: 'root' });
    g.setNode("thanks", { labelType: "html", label: getNumber(4, "black") + "Tom Hanks", width: 120, height: 50, class: 'root' });
    g.setNode("swilliams", { label: "Saul Williams", width: 120, height: 50, class: 'disabled' });
    g.setNode("pre", { labelType: 'html', label: getNumber(2, '#1F57CF') + 'Pre rule', width: 120, height: 10, class: 'root' });
    g.setNode("post", { labelType: 'html', label: getNumber(3, '#BF1FCF') + 'Post rule', width: 120, height: 10, class: 'root' });
    g.setNode("dhoffman", { label: "Dustin Hoffman", width: 120, height: 50 });
    g.setNode("mdamon", { label: "Matt Damon", width: 120, height: 50 });
    g.setNode("wsmith", { label: "Will Smith", width: 120, height: 50 });
    */
    //exsample add node
    
    
    // Round the corners of the nodes
    g.nodes().forEach(function(v) {
      var node = g.node(v);
      node.rx = node.ry = 10;
    });

    g.setEdge("204111", "204114");
    g.setEdge("206183", "204451");
    g.setEdge("208269", "204271");
    g.setEdge("204252", "204271");
    g.setEdge("204252", "204451");
    g.setEdge("204252", "204321");
    g.setEdge("204114", "204203");
    g.setEdge("204114", "204212");
    g.setEdge("204114", "204231");
    g.setEdge("204114", "204232");
    g.setEdge("204114", "204252");
    g.setEdge("204212", "204315");
    g.setEdge("204212", "204361");
    g.setEdge("204231", "204341");
    g.setEdge("204232", "204390");
    g.setEdge("204321", "204390");
    g.setEdge("204341", "204390");
    g.setEdge("204361", "204390");
    g.setEdge("204496", "204497")

    /*
    // Add edges to the graph.
    g.setEdge("init", "thanks");
    g.setEdge("thanks", "swilliams");
    g.setEdge("swilliams", "dhoffman");
    g.setEdge("pre", "mdamon");
    g.setEdge("pre", "wsmith");
    g.setEdge("mdamon", "swilliams");
    */
    

    // Render

    // Set up an SVG group so that we can translate the final graph.
    var svg = d3.select('svg'),
        svgGroup = svg.append('g');

    // Run the renderer. This is what draws the final graph.
    render(d3.select('svg g'), g);

    // Size the container to the graph
    svg.attr('width', g.graph().width + PADDING);
    svg.attr('height', g.graph().height + PADDING);

    // Center the graph
    var offset = PADDING / 2;
    svgGroup.attr(
      'transform', 'translate(' + offset + ', ' + offset + ')'
    );

    // Inline styles are necessary so dagre can compute dimensions.
    function getNumber(n, color) {
      return '<span style="width: 20px; height: 20px; margin-right: 6px; background: ' + color + '; display: inline-block; text-align: center; border-radius: 10px; color: #fff; line-height: 21px;">' + n + '</span>'
    }
  </script>
</body>
</html>
